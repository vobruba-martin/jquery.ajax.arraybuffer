/*
 jQuery.ajax.arraybuffer
 https://github.com/vobruba-martin/jquery.ajax.arraybuffer
 Copyright (C) 2016 Martin Vobruba
 Licensed MIT (/blob/master/LICENSE.md)
*/
'use strict';jQuery.ajaxTransport("arraybuffer",function(a){var n=0,k={},f=jQuery.ajaxSettings.xhr(),f=!!f&&"withCredentials"in f;window.attachEvent&&window.attachEvent("onunload",function(){for(var a in k)k[+a](void 0,!0)});if(!a.crossDomain||f){var d=null;return{send:function(c,f){var e,b=a.xhr(),m=++n;b.open(a.type+"",a.url+"",a.async,a.username,a.password);b.responseType="arraybuffer";if(a.xhrFields)for(e in a.xhrFields)b[e]=a.xhrFields[e];a.mimeType&&b.overrideMimeType&&b.overrideMimeType(a.mimeType);
a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&b.setRequestHeader(e,c[e]+"");b.send(a.hasContent&&a.data||null);d=function(e,c){var g,l,h;if(d&&(c||4===b.readyState))if(delete k[m],d=null,b.onreadystatechange=jQuery.noop,c)4!==b.readyState&&b.abort();else{h={};g=b.status;try{h.arraybuffer=b.response}catch(p){}try{l=b.statusText}catch(p){l=""}g||!a.isLocal||a.crossDomain?1223===g&&(g=204):g=h.arraybuffer?200:404}h&&f(+g,l+"",h,b.getAllResponseHeaders())};
a.async?4===b.readyState?window.setTimeout(d):b.onreadystatechange=k[m]=d:d()},abort:function(){d&&d(void 0,!0)}}}});
